#!/usr/bin/env bash

source bin/params

phpVersionContainers=( php-7.2 php-7.3 php-7.4 )

databasesContainers=( postgres-9 postgres-10 postgres-11 postgres-12 )

for databaseVersion in "${databasesContainers[@]}"
do
    for phpVersion in "${phpVersionContainers[@]}"
    do
        echo -e "Starting functional tests. PHP version: ${FONT_BOLD}${phpVersion}${FONT_NORMAL}. Database: ${FONT_BOLD}${databaseVersion}${FONT_NORMAL}"
        docker-compose run --rm -e DATABASE_HOST=${databaseVersion} ${phpVersion} vendor/bin/phpunit --configuration=.phpunit.xml --no-coverage --testsuite="Functional tests"
    done
done
